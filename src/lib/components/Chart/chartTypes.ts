// Chart component shared types and constants

import type { KLineData } from "klinecharts";
import type ChartCandlestick from "lucide-svelte/icons/chart-candlestick";
import type ChartLine from "lucide-svelte/icons/chart-line";

// ============================================================================
// CONSTANTS
// ============================================================================

export const DEFAULT_DRAWING_COLOR = "#2962FF";

export const CHART_COLORS = {
  UP: "#22ab94", // Green for price increase
  DOWN: "#f23645", // Red for price decrease
  POSITIVE: "#10B981", // Green for positive values (earnings beat, etc.)
  NEGATIVE: "#B91C1C", // Red for negative values (earnings miss, etc.)
  NEUTRAL: "#9ca3af", // Gray for neutral values
} as const;

export const TIMEFRAMES = [
  "1min",
  "5min",
  "15min",
  "30min",
  "1hour",
  "4hour",
  "1D",
  "1W",
  "1M",
] as const;

export const VALID_CHART_TYPES = [
  "bars",
  "candles",
  "hollow_candles",
  "heikin_ashi",
  "line_step",
  "area",
  "hlc_area",
  "high_low",
] as const;

export const VALID_DRAWING_MODES = [
  "normal",
  "weak_magnet",
  "strong_magnet",
] as const;

export const VALID_TOOL_GROUPS = [
  "lines",
  "channels",
  "shapes",
  "fibonacci",
  "waves",
] as const;

// Color palette for drawings
export const DRAWING_COLORS = [
  "#FF0000",
  "#F97316",
  "#FACC15",
  "#22C55E",
  "#10B981",
  "#3B82F6",
  "#8B5CF6",
  "#EC4899",
  "#FFFFFF",
  "#6B7280",
];

// Thickness options
export const LINE_THICKNESSES = [1, 2, 3, 4, 5];

// Line style options
export const LINE_STYLES = [
  { id: "solid", label: "Solid", dashValue: [] },
  { id: "dashed", label: "Dashed", dashValue: [6, 4] },
  { id: "dotted", label: "Dotted", dashValue: [2, 2] },
] as const;

// ============================================================================
// TYPES
// ============================================================================

export type Timeframe = (typeof TIMEFRAMES)[number];

export type ChartTypeId = (typeof VALID_CHART_TYPES)[number];

export type DrawingMode = (typeof VALID_DRAWING_MODES)[number];

export type ToolGroupId = (typeof VALID_TOOL_GROUPS)[number];

export type FinancialIndicatorPeriod = "annual" | "quarterly" | "ttm";

export interface ChartTypeOption {
  id: ChartTypeId;
  label: string;
  icon: typeof ChartCandlestick | typeof ChartLine;
}

export interface ChartSettings {
  chartType: string;
  activeRange: string;
  showEarnings?: boolean;
  showDividends?: boolean;
  showNewsFlow?: boolean;
  showShortInterest?: boolean;
  financialIndicatorPeriod?: FinancialIndicatorPeriod;
  revenueIndicatorPeriod?: FinancialIndicatorPeriod;
  epsIndicatorPeriod?: FinancialIndicatorPeriod;
  statementIndicatorPeriods?: Record<string, FinancialIndicatorPeriod>;
  selectedToolByGroup?: Record<string, string>;
  drawingMode?: DrawingMode;
  drawingsLocked?: boolean;
  drawingsVisible?: boolean;
  savedAt?: number;
}

// Drawing tool types
export interface ToolOption {
  id: string;
  label: string;
  overlay: string;
  icon: string;
}

export interface ToolGroup {
  id: string;
  label: string;
  options: ToolOption[];
}

// Selected overlay for contextual toolbar
export interface SelectedOverlay {
  id: string;
  name: string;
  lock: boolean;
  styles: Record<string, any>;
}

// Overlay data interface for type safety
export interface ChartOverlayData {
  name: string;
  points?: Array<{ timestamp: number; value: number }>;
  extendData?: unknown;
  styles?: Record<string, unknown>;
}

// ============================================================================
// EVENT MARKER TYPES
// ============================================================================

export interface EarningsData {
  date: string;
  period: string;
  period_year: number;
  eps: string | number | null;
  eps_est: string | number | null;
  eps_surprise: string | number | null;
  eps_surprise_percent: string | number | null;
  revenue: string | number | null;
  revenue_est: string | number | null;
  revenue_surprise: string | number | null;
  revenue_surprise_percent: string | number | null;
  time?: string; // "bmo" (before market open) or "amc" (after market close)
}

export interface EarningsMarker {
  earnings: EarningsData;
  timestamp: number;
  x: number;
  visible: boolean;
  isFuture: boolean;
}

export interface DividendData {
  date: string; // ex-dividend date
  adjDividend: number;
  declarationDate?: string;
  recordDate?: string;
  paymentDate?: string;
}

export interface DividendMarker {
  dividend: DividendData;
  timestamp: number;
  x: number;
  visible: boolean;
}

export interface NewsData {
  date: string;
  text: string;
  changesPercentage: number | string;
}

export interface NewsMarker {
  news: NewsData;
  timestamp: number;
  x: number;
  visible: boolean;
}

export interface ShortInterestData {
  recordDate: string;
  totalShortInterest: number | string;
  shortPercentOfFloat: number;
  daysToCover: number;
  shortPriorMo: number | string;
  percentChangeMoMo: number;
  shortPercentOfOut: number;
}

export interface ShortInterestMarker {
  shortInterest: ShortInterestData;
  timestamp: number;
  x: number;
  y: number;
  visible: boolean;
}

// ============================================================================
// OPTIONS/OVERLAY TYPES (GEX, DEX, OI, etc.)
// ============================================================================

export interface GexDexStrikeData {
  strike: number;
  call_gex: number;
  put_gex: number;
  call_dex: number;
  put_dex: number;
  net_gex?: number;
  net_dex?: number;
}

export interface GexDexLevel {
  strike: number;
  value: number;
  absValue: number;
  callValue: number;
  putValue: number;
  y: number;
  visible: boolean;
  isPositive: boolean;
  intensity: number;
  showLabel: boolean;
}

export interface OiStrikeData {
  strike: number;
  call_oi: number;
  put_oi: number;
  total_oi?: number;
}

export interface OiLevel {
  strike: number;
  callOi: number;
  putOi: number;
  totalOi: number;
  expiration: string | null;
  dte: number | null;
  y: number;
  visible: boolean;
  intensity: number;
  showLabel: boolean;
}

export interface HottestContract {
  strike_price: number;
  option_type: "C" | "P";
  date_expiration: string;
  volume: number;
  open_interest: number;
  last: number;
  high: number;
  low: number;
  iv: number;
  total_premium: number;
  option_symbol: string;
}

export interface HottestLevel {
  strike: number;
  optionType: "C" | "P";
  expiration: string;
  volume: number;
  openInterest: number;
  iv: number;
  premium: number;
  last: number;
  dte: number | null;
  y: number;
  visible: boolean;
  intensity: number;
  showLabel: boolean;
}

export interface MaxPainDataPoint {
  expiration: string;
  maxPain: number;
}

export interface MaxPainLevel {
  price: number;
  expiration: string;
  dte: number | null;
  y: number;
  labelY: number;
  visible: boolean;
  isPrimary: boolean;
  intensity: number;
}

export type AnalystTargetKey = "low" | "average" | "median" | "high";

export interface AnalystTargetSummary {
  low: number | null;
  average: number | null;
  median: number | null;
  high: number | null;
  numAnalysts: number | null;
  consensus: string | null;
}

export interface AnalystTargetLevel {
  key: AnalystTargetKey;
  label: string;
  price: number;
  y: number;
  labelY: number;
  visible: boolean;
  color: string;
}

// ============================================================================
// INDICATOR TYPES
// ============================================================================

export interface IndicatorDefinition {
  id: string;
  label: string;
  indicatorName: string;
  category: string;
  infoKey?: string;
  defaultParams: number[];
  pane: "candle" | "panel";
  height?: number;
  defaultEnabled?: boolean;
  isOverlay?: boolean;
}

// ============================================================================
// SVG ICON PATHS
// ============================================================================

export const toolIcons: Record<string, string> = {
  // Lines
  horizontalStraightLine:
    "M12.41465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L12.41465,12C12.20873,12.5826,11.65311,13,11,13C10.34689,13,9.79127,12.5826,9.58535,12L3.5,12C3.223857,12,3,11.77614,3,11.5C3,11.22386,3.223857,11,3.5,11L9.58535,11C9.79127,10.4174,10.34689,10,11,10C11.65311,10,12.20873,10.4174,12.41465,11Z",
  horizontalRayLine:
    "M6.91465,11L11.08535,11C11.29127,10.4174,11.84689,10,12.5,10C13.15311,10,13.70873,10.4174,13.91465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L13.91465,12C13.70873,12.5826,13.15311,13,12.5,13C11.84689,13,11.29127,12.5826,11.08535,12L6.91465,12C6.70873,12.5826,6.15311,13,5.5,13C4.671573,13,4,12.32843,4,11.5C4,10.671573,4.671573,10,5.5,10C6.15311,10,6.70873,10.4174,6.91465,11Z",
  verticalStraightLine:
    "M11,12.41465L11,18.5C11,18.7761,11.22386,19,11.5,19C11.77614,19,12,18.7761,12,18.5L12,12.41465C12.5826,12.20873,13,11.65311,13,11C13,10.34689,12.5826,9.79127,12,9.58535L12,3.5C12,3.223857,11.77614,3,11.5,3C11.22386,3,11,3.223857,11,3.5L11,9.58535C10.4174,9.79127,10,10.34689,10,11C10,11.65311,10.4174,12.20873,11,12.41465Z",
  horizontalSegment:
    "M6.91465,11L11.08535,11C11.29127,10.4174,11.84689,10,12.5,10C13.15311,10,13.70873,10.4174,13.91465,11L17.08535,11C17.29127,10.4174,17.84689,10,18.5,10C19.32843,10,20,10.67157,20,11.5C20,12.32843,19.32843,13,18.5,13C17.84689,13,17.29127,12.5826,17.08535,12L13.91465,12C13.70873,12.5826,13.15311,13,12.5,13C11.84689,13,11.29127,12.5826,11.08535,12L6.91465,12C6.70873,12.5826,6.15311,13,5.5,13C4.671573,13,4,12.32843,4,11.5C4,10.67157,4.671573,10,5.5,10C6.15311,10,6.70873,10.4174,6.91465,11Z",
  verticalRayLine:
    "M11,6.91465L11,11.08535C10.4174,11.29127,10,11.84689,10,12.5C10,13.15311,10.4174,13.70873,11,13.91465L11,18.5C11,18.7761,11.22386,19,11.5,19C11.77614,19,12,18.7761,12,18.5L12,13.91465C12.5826,13.70873,13,13.15311,13,12.5C13,11.84689,12.5826,11.29127,12,11.08535L12,6.91465C12.5826,6.70873,13,6.15311,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,6.15311,10.4174,6.70873,11,6.91465Z",
  verticalSegment:
    "M11,6.91465L11,11.08535C10.4174,11.29127,10,11.84689,10,12.5C10,13.15311,10.4174,13.70873,11,13.91465L11,17.08535C10.4174,17.29127,10,17.84689,10,18.5C10,19.32843,10.67157,20,11.5,20C12.32843,20,13,19.32843,13,18.5C13,17.84689,12.5826,17.29127,12,17.08535L12,13.91465C12.5826,13.70873,13,13.15311,13,12.5C13,11.84689,12.5826,11.29127,12,11.08535L12,6.91465C12.5826,6.70873,13,6.15311,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,6.15311,10.4174,6.70873,11,6.91465Z",
  straightLine:
    "M5.146447,15.753C4.9511845,15.9483,4.9511845,16.2649,5.146447,16.4602C5.341709,16.6554,5.658291,16.6554,5.853554,16.4602L8.1566,14.15711C8.35241,14.25082,8.57173,14.3033,8.8033,14.3033C9.63173,14.3033,10.3033,13.63172,10.3033,12.80329C10.3033,12.57172,10.25082,12.35241,10.15712,12.15659L12.1566,10.15711C12.35241,10.25082,12.57173,10.30329,12.8033,10.30329C13.63173,10.30329,14.3033,9.63172,14.3033,8.80329C14.3033,8.57172,14.25082,8.35241,14.15712,8.15659L16.4602,5.853553C16.6554,5.658291,16.6554,5.341709,16.4602,5.146447C16.2649,4.9511843,15.9483,4.9511843,15.753,5.146447L13.45001,7.44948C13.25419,7.35577,13.03487,7.30329,12.8033,7.30329C11.97487,7.30329,11.3033,7.97487,11.3033,8.80329C11.3033,9.03487,11.35578,9.25419,11.44949,9.45001L9.45001,11.44948C9.25419,11.35577,9.03487,11.30329,8.8033,11.30329C7.97487,11.30329,7.3033,11.97487,7.3033,12.80329C7.3033,13.03487,7.35578,13.25419,7.44949,13.45001L5.146447,15.753Z",
  rayLine:
    "M7.57333,14.54568C7.66704,14.7415,7.71951,14.96081,7.71951,15.1924C7.71951,16.0208,7.04794,16.6924,6.21951,16.6924C5.39109,16.6924,4.71951,16.0208,4.71951,15.1924C4.71951,14.36395,5.39109,13.69238,6.21951,13.69238C6.45109,13.69238,6.67041,13.74486,6.86623,13.83857L9.8657,10.8391C9.77199,10.64328,9.71951,10.42396,9.71951,10.19238C9.71951,9.36395,10.39108,8.69238,11.21951,8.69238C11.45109,8.69238,11.67041,8.74486,11.86623,8.83857L15.46211,5.24265C15.65741,5.04738,15.97401,5.04738,16.16921,5.24265C16.36451,5.43791,16.36451,5.75449,16.16921,5.94975L12.57333,9.54568C12.66704,9.7415,12.71951,9.96081,12.71951,10.19238C12.71951,11.02081,12.04794,11.69238,11.21951,11.69238C10.98794,11.69238,10.76863,11.63991,10.57281,11.5462L7.57333,14.54568Z",
  arrow:
    "M17.0643,7.03386L18,3.58578L14.5078,4.5097L15.3537,5.34493L6.02026,14.56058C5.87635,14.51748,5.72366,14.49428,5.5655,14.49428C4.7009,14.49428,4,15.18638,4,16.04008C4,16.89378,4.7009,17.58578,5.5655,17.58578C6.43011,17.58578,7.13101,16.89378,7.13101,16.04008C7.13101,15.72228,7.03392,15.42698,6.86744,15.18138L16.0917,6.0736L17.0643,7.03386Z",
  segment:
    "M15.71951,8.46178C16.54791,8.46178,17.21951,7.79021,17.21951,6.96178C17.21951,6.13335,16.54791,5.46178,15.71951,5.46178C14.89108,5.46178,14.21951,6.13335,14.21951,6.96178C14.21951,7.19335,14.27199,7.41267,14.36569,7.60849L7.36622,14.60796C7.1704,14.51426,6.95108,14.46178,6.71951,14.46178C5.89109,14.46178,5.21951,15.13335,5.21951,15.96178C5.21951,16.79018,5.89109,17.46178,6.71951,17.46178C7.54794,17.46178,8.21951,16.79018,8.21951,15.96178C8.21951,15.73018,8.16703,15.51088,8.07332,15.31507L15.0728,8.31559C15.26861,8.4093,15.48791,8.46178,15.71951,8.46178Z",
  priceLine:
    "M6.91465,13.00505L18.5,13.00505C18.7761,13.00505,19,13.22891,19,13.50505C19,13.78119,18.7761,14.00505,18.5,14.00505L6.91465,14.00505C6.70873,14.58765,6.15311,15.00505,5.5,15.00505C4.671573,15.00505,4,14.33348,4,13.50505C4,12.67662,4.671573,12.00505,5.5,12.00505C6.15311,12.00505,6.70873,12.42245,6.91465,13.00505ZM7.81404,11.625L10.48591,11.625L10.48591,10.90625L9.65193,10.90625L9.65193,7.125L8.99763,7.125C8.71443,7.306641,8.4156,7.419922,7.96443,7.498047L7.96443,8.05078L8.77497,8.05078L8.77497,10.90625L7.81404,10.90625L7.81404,11.625ZM11.08162,11.625L14.0562,11.625L14.0562,10.88281L13.09724,10.88281C12.8863,10.88281,12.59333,10.90625,12.36482,10.93555C13.17537,10.11328,13.84724,9.2207,13.84724,8.39062C13.84724,7.541016,13.28865,7,12.4488,7C11.84333,7,11.44685,7.234375,11.03279,7.679688L11.52497,8.16797C11.74763,7.914062,12.0113,7.697266,12.33552,7.697266C12.7613,7.697266,13.00154,7.982422,13.00154,8.43359C13.00154,9.14648,12.29255,10.00781,11.08162,11.11523L11.08162,11.625ZM15.9605,11.75C16.8121,11.75,17.5269,11.2832,17.5269,10.4375C17.5269,9.82031,17.1422,9.43945,16.6441,9.30078L16.6441,9.27148C17.1129,9.08594,17.3824,8.7207,17.3824,8.21289C17.3824,7.421875,16.8004,7,15.9429,7C15.4215,7,14.9957,7.210938,14.6109,7.541016L15.066,8.11133C15.3258,7.849609,15.5836,7.697266,15.9019,7.697266C16.2789,7.697266,16.4957,7.914062,16.4957,8.28125C16.4957,8.70898,16.2301,9,15.4215,9L15.4215,9.63672C16.3804,9.63672,16.6383,9.91992,16.6383,10.38086C16.6383,10.79688,16.3336,11.03125,15.8824,11.03125C15.4742,11.03125,15.1578,10.82227,14.8922,10.55078L14.4781,11.13281C14.7906,11.48633,15.2652,11.75,15.9605,11.75Z",
  infoLine:
    "M6.5,16.5C5.67157,16.5,5,15.82843,5,15C5,14.17157,5.67157,13.5,6.5,13.5C7.32843,13.5,8,14.17157,8,15C8,15.82843,7.32843,16.5,6.5,16.5ZM15.5,8.5C14.67157,8.5,14,7.82843,14,7C14,6.17157,14.67157,5.5,15.5,5.5C16.32843,5.5,17,6.17157,17,7C17,7.82843,16.32843,8.5,15.5,8.5ZM7.85355,14.14645L14.14645,7.85355C14.34171,7.65829,14.34171,7.34171,14.14645,7.14645C13.95118,6.95118,13.63461,6.95118,13.43934,7.14645L7.14645,13.43934C6.95118,13.63461,6.95118,13.95118,7.14645,14.14645C7.34171,14.34171,7.65829,14.34171,7.85355,14.14645ZM10,17H18V19H10V17ZM11,16H17V15H11V16ZM12,14H16V13H12V14Z",
  // Channels
  priceChannelLine:
    "M3.146447,14.17813C2.9511847,13.98283,2.9511847,13.66623,3.146447,13.47093L7.39146,9.22597C7.35417,9.09511,7.33421,8.95695,7.33421,8.81412C7.33421,7.9857,8.00578,7.31412,8.83421,7.31412C8.97703,7.31412,9.11519,7.33409,9.24605,7.37137L13.753,2.86437C13.9483,2.66911,14.2649,2.66911,14.4602,2.86437C14.6554,3.05964,14.6554,3.37622,14.4602,3.57148L10.06916,7.96248C10.23631,8.20439,10.33421,8.49783,10.33421,8.81412C10.33421,9.64255,9.66264,10.31412,8.83421,10.31412C8.51791,10.31412,8.22448,10.21623,7.98256,10.04908L3.853554,14.17813C3.658291,14.37333,3.341709,14.37333,3.146447,14.17813ZM7.67736,19.18853C7.4821,18.99323,7.4821,18.67663,7.67736,18.48143L9.9804,16.17833C9.88669,15.98253,9.83421,15.76323,9.83421,15.53163C9.83421,14.70323,10.50578,14.03163,11.33421,14.03163C11.56579,14.03163,11.78511,14.08413,11.98093,14.17783L13.9804,12.17836C13.8867,11.98254,13.8342,11.76322,13.8342,11.53164C13.8342,10.70321,14.5058,10.03164,15.3342,10.03164C15.5658,10.03164,15.7851,10.08412,15.9809,10.17783L18.284,7.8748C18.4792,7.67954,18.7958,7.67954,18.9911,7.8748C19.1863,8.07006,19.1863,8.38664,18.9911,8.58191L16.688,10.88494C16.7817,11.08076,16.8342,11.30007,16.8342,11.53164C16.8342,12.36007,16.1626,13.03163,15.3342,13.03163C15.1026,13.03163,14.8833,12.97913,14.6875,12.88543L12.688,14.88493C12.7817,15.08073,12.8342,15.30003,12.8342,15.53163C12.8342,16.36003,12.1626,17.03163,11.3342,17.03163C11.1026,17.03163,10.8833,16.97913,10.6875,16.88543L8.38446,19.18853C8.1892,19.38373,7.87262,19.38373,7.67736,19.18853Z",
  parallelStraightLine:
    "M3.14645,10.8536C2.95118,10.6583,2.95118,10.3417,3.14645,10.1464L10.1464,3.14645C10.3417,2.95118,10.6583,2.95118,10.8536,3.14645C11.0488,3.34171,11.0488,3.65829,10.8536,3.85355L3.85355,10.8536C3.65829,11.0488,3.34171,11.0488,3.14645,10.8536ZM11.1464,18.8536C10.9512,18.6583,10.9512,18.3417,11.1464,18.1464L18.1464,11.1464C18.3417,10.9512,18.6583,10.9512,18.8536,11.1464C19.0488,11.3417,19.0488,11.6583,18.8536,11.8536L11.8536,18.8536C11.6583,19.0488,11.3417,19.0488,11.1464,18.8536Z",
  // Shapes
  rect: "M19,4.5C19,5.15311,18.5826,5.70873,18,5.91465L18,18.5C18,18.7761,17.7761,19,17.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.8469,3.417404,17.2913,4,17.0854L4,4.5C4,4.22386,4.22386,4,4.5,4L16.0854,4C16.2913,3.417404,16.8469,3,17.5,3C18.3284,3,19,3.671573,19,4.5ZM5,5L16.0854,5C16.236,5.42621,16.5738,5.764,17,5.91465L17,18L5.91465,18C5.764,17.5738,5.42621,17.236,5,17.0854L5,5Z",
  circle:
    "M11,5C7.68629,5,5,7.68629,5,11C5,14.3137,7.68629,17,11,17C14.3137,17,17,14.3137,17,11C17,7.68629,14.3137,5,11,5ZM4,11C4,7.13401,7.13401,4,11,4C14.866,4,18,7.13401,18,11C18,14.866,14.866,18,11,18C7.13401,18,4,14.866,4,11Z",
  triangle:
    "M11.57625,6.9981C11.55099,6.99936,11.52557,7,11.5,7C11.34,7,11.18584,6.97495,11.04125,6.9285L5.55401,16.4327C5.71376,16.5905,5.83826,16.7839,5.91465,17L16.0854,17C16.2187,16.6227,16.4987,16.3147,16.8569,16.1445L11.57625,6.9981ZM12.50759,6.61122C12.81005,6.33679,13,5.94058,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,5.80059,10.08841,6.08052,10.24066,6.31522L4.64514,16.0069C4.59738,16.0023,4.54896,16,4.5,16C3.671573,16,3,16.6716,3,17.5C3,18.3284,3.671573,19,4.5,19C5.15311,19,5.70873,18.5826,5.91465,18L16.0854,18C16.2913,18.5826,16.8469,19,17.5,19C18.3284,19,19,18.3284,19,17.5C19,16.8365,18.5691,16.2735,17.9719,16.0757L12.50759,6.61122Z",
  parallelogram:
    "M19.6401,7.99355C20.4028,7.92291,21,7.2812,21,6.5C21,5.671573,20.3284,5,19.5,5C18.8469,5,18.2913,5.417404,18.0854,6L7.62067,6C7.34453,6,7.12067,6.22386,7.12067,6.5C7.12067,6.5479,7.12741,6.59423,7.13999,6.63809L3.2294,15.0243C2.530138,15.1517,2,15.764,2,16.5C2,17.3284,2.671573,18,3.5,18C4.15311,18,4.70873,17.5826,4.91465,17L14.5963,17C14.6456,17.076,14.7162,17.1396,14.8044,17.1807C15.0546,17.2974,15.3521,17.1891,15.4688,16.9388L19.6401,7.99355ZM14.7896,16.0293L18.6551,7.7396C18.3942,7.56144,18.1925,7.30307,18.0854,7L8.0746,7L4.25044,15.2009C4.55701,15.3784,4.79493,15.6613,4.91465,16L14.6207,16C14.68,16,14.7368,16.0103,14.7896,16.0293Z",
  // Fibonacci
  fibonacciLine:
    "M13.1889,6C12.98303,6.5826,12.42741,7,11.7743,7C11.12119,7,10.56557,6.5826,10.35965,6L3.5,6C3.223857,6,3,5.77614,3,5.5C3,5.22386,3.223857,5,3.5,5L10.35965,5C10.56557,4.4174,11.12119,4,11.7743,4C12.42741,4,12.98303,4.4174,13.1889,5L18.5,5C18.7761,5,19,5.22386,19,5.5C19,5.77614,18.7761,6,18.5,6L13.1889,6ZM3,8.5C3,8.22386,3.223857,8,3.5,8L18.5,8C18.7761,8,19,8.22386,19,8.5C19,8.77614,18.7761,9,18.5,9L3.5,9C3.223857,9,3,8.77614,3,8.5ZM3.27855,11.5C3.27855,11.22386,3.50241,11,3.77855,11L18.7785,11C19.0547,11,19.2785,11.22386,19.2785,11.5C19.2785,11.77614,19.0547,12,18.7785,12L3.77855,12C3.50241,12,3.27855,11.77614,3.27855,11.5ZM3.13927,14.5C3.13927,14.2239,3.36312,14,3.63927,14L18.6393,14C18.9154,14,19.1393,14.2239,19.1393,14.5C19.1393,14.7761,18.9154,15,18.6393,15L3.63927,15C3.36312,15,3.13927,14.7761,3.13927,14.5ZM13.1889,18C12.98303,18.5826,12.42741,19,11.7743,19C11.12119,19,10.56557,18.5826,10.35965,18L3.77855,18C3.50241,18,3.27855,17.7761,3.27855,17.5C3.27855,17.2239,3.50241,17,3.77855,17L10.35965,17C10.56557,16.4174,11.12119,16,11.7743,16C12.42741,16,12.98303,16.4174,13.1889,17L18.7785,17C19.0547,17,19.2785,17.2239,19.2785,17.5C19.2785,17.7761,19.0547,18,18.7785,18L13.1889,18Z",
  fibonacciExtension:
    "M17,4.5C17,5.32843,16.3284,6,15.5,6C15.0931,6,14.7241,5.83802,14.4539,5.57503L5.98992,8.32515C5.99658,8.38251,6,8.44085,6,8.5C6,9.15311,5.5826,9.70873,5,9.91465L5,11.08535C5.42621,11.236,5.764,11.57379,5.91465,12L19.5,12C19.7761,12,20,12.22386,20,12.5C20,12.77614,19.7761,13,19.5,13L5.91465,13C5.70873,13.5826,5.15311,14,4.5,14C3.671573,14,3,13.3284,3,12.5C3,11.84689,3.417404,11.29127,4,11.08535L4,9.91465C3.417404,9.70873,3,9.15311,3,8.5C3,7.67157,3.671573,7,4.5,7C4.90411,7,5.2709,7.15981,5.54062,7.41967L14.0093,4.66802C14.0032,4.61286,14,4.5568,14,4.5C14,3.671573,14.6716,3,15.5,3C16.3284,3,17,3.671573,17,4.5ZM4,15.5C4,15.2239,4.22386,15,4.5,15L19.5,15C19.7761,15,20,15.2239,20,15.5C20,15.7761,19.7761,16,19.5,16L4.5,16C4.22386,16,4,15.7761,4,15.5ZM4,18.5C4,18.2239,4.22386,18,4.5,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L4.5,19C4.22386,19,4,18.7761,4,18.5Z",
  fibonacciSpeedResistanceFan:
    "M4,17.0854L4,3.5C4,3.223858,4.22386,3,4.5,3C4.77614,3,5,3.223858,5,3.5L5,10L7.57584,10L9.8127,4.46359C9.91614,4.20756,10.20756,4.08386,10.46359,4.1873C10.71963,4.29075,10.84333,4.58216,10.73988,4.8382L8.65438,10L11.08535,10C11.29127,9.4174,11.84689,9,12.5,9C12.65154,9,12.79784,9.02247,12.93573,9.06427L16.6464,5.35355C16.8417,5.15829,17.1583,5.15829,17.3536,5.35355C17.5488,5.54882,17.5488,5.8654,17.3536,6.06066L13.7475,9.66675C13.907,9.90508,14,10.19168,14,10.5C14,11.15311,13.5826,11.70873,13,11.91465L13,14.3638L18.3714,12.1936C18.6274,12.09015,18.9188,12.21385,19.0222,12.46989C19.1257,12.72592,19.002,13.0173,18.746,13.1208L13,15.4423L13,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.8469,3.417404,17.2913,4,17.0854ZM6.37295,17.0413L12,14.7678L12,11.91465C11.88136,11.87271,11.76956,11.81627,11.66675,11.74746L6.37295,17.0413ZM12,15.8463L6.66947,18L12,18L12,15.8463ZM6.38629,15.6137L8.25035,11L11,11L6.38629,15.6137ZM5,11L7.17182,11L5,16.3754L5,11Z",
  fibonacciCircle:
    "M11,5C7.68629,5,5,7.68629,5,11C5,14.3137,7.68629,17,11,17C14.3137,17,17,14.3137,17,11C17,7.68629,14.3137,5,11,5ZM4,11C4,7.13401,7.13401,4,11,4C14.866,4,18,7.13401,18,11C18,14.866,14.866,18,11,18C7.13401,18,4,14.866,4,11ZM11,7C8.79086,7,7,8.79086,7,11C7,13.2091,8.79086,15,11,15C13.2091,15,15,13.2091,15,11C15,8.79086,13.2091,7,11,7ZM11,9C9.89543,9,9,9.89543,9,11C9,12.1046,9.89543,13,11,13C12.1046,13,13,12.1046,13,11C13,9.89543,12.1046,9,11,9Z",
  // Patterns
  xabcd:
    "M5.92159,5.93994C6.04014,5.90529,6.15262,5.85639,6.25704,5.79523L9.12729,9.89437C9.04545,10.07959,9,10.28449,9,10.5C9,10.79522,9.08529,11.07053,9.23257,11.30262L4.97573,16.7511L5.92159,5.93994ZM4.92259,5.88484C4.38078,5.65866,4,5.1238,4,4.5C4,3.671573,4.67157,3,5.5,3C6.2157,3,6.81433,3.50124,6.96399,4.17183L15.1309,4.88634C15.3654,4.36387,15.8902,4,16.5,4C17.3284,4,18,4.67157,18,5.5C18,6.08983,17.6596,6.60015,17.1645,6.84518L18.4264,14.0018C18.4508,14.0006,18.4753,14,18.5,14C19.3284,14,20,14.6716,20,15.5C20,16.3284,19.3284,17,18.5,17C17.9325,17,17.4386,16.6849,17.1838,16.22L5.99686,18.5979C5.94643,19.3807,5.29554,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.8693,3.38929,17.3295,3.94071,17.1077L4.92259,5.88484ZM5.72452,17.6334C5.69799,17.596,5.6698,17.5599,5.64004,17.5251L10.01843,11.921C10.16958,11.9722,10.33155,12,10.5,12C10.80059,12,11.08052,11.9116,11.31522,11.7593L17.0606,15.0765C17.0457,15.1271,17.0335,15.1789,17.0239,15.2317L5.72452,17.6334ZM11.92855,10.9587L17.4349,14.1379L16.1699,6.96356C15.9874,6.92257,15.8174,6.8483,15.6667,6.74746L11.99771,10.4165C11.99923,10.4441,12,10.472,12,10.5C12,10.66,11.97495,10.8142,11.92855,10.9587ZM10.5,9C10.25983,9,10.03285,9.05644,9.83159,9.15679L7.04919,5.1831L15.0493,5.88302C15.054,5.90072,15.059,5.91829,15.0643,5.93573L11.56066,9.43934C11.28921,9.16789,10.91421,9,10.5,9Z",
  abcd: "M21,5.5C21,6.32843,20.3284,7,19.5,7C19.4136,7,19.3289,6.99269,19.2465,6.97866L15.6257,15.5086C15.8587,15.7729,16,16.12,16,16.5C16,17.3284,15.3284,18,14.5,18C13.8469,18,13.2913,17.5826,13.0854,17L3.91465,17C3.70873,17.5826,3.15311,18,2.5,18C1.671573,18,1,17.3284,1,16.5C1,15.6716,1.671573,15,2.5,15C2.584,15,2.66643,15.0069,2.74668,15.0202L6.36934,6.48574C6.13933,6.22213,6,5.87733,6,5.5C6,4.671573,6.67157,4,7.5,4C8.15311,4,8.70873,4.417404,8.91465,5L18.0854,5C18.2913,4.417404,18.8469,4,19.5,4C20.3284,4,21,4.671573,21,5.5ZM18.0854,6L8.91465,6C8.89258,6.06243,8.8665,6.12296,8.83672,6.18128L13.9814,15.0921C14.143,15.0325,14.3177,15,14.5,15C14.584,15,14.6664,15.0069,14.7467,15.0202L18.3693,6.48574C18.2462,6.3446,18.149,6.1802,18.0854,6ZM13.2036,15.745L8.08611,6.88118C7.90605,6.95768,7.70797,7,7.5,7C7.41359,7,7.32888,6.99269,7.24647,6.97866L3.62571,15.5086C3.7512,15.651,3.8501,15.8174,3.91465,16L13.0854,16C13.1169,15.9108,13.1566,15.8255,13.2036,15.745Z",
  // Utility icons (viewBox 28x28 for TradingView consistency)
  magnet:
    "M14 10a2 2 0 0 0-2 2v11H6V12c0-4.416 3.584-8 8-8s8 3.584 8 8v11h-6V12a2 2 0 0 0-2-2zm-3 2a3 3 0 0 1 6 0v10h4V12c0-3.864-3.136-7-7-7s-7 3.136-7 7v10h4V12z M6.5 18h5v1h-5zm10 0h5v1h-5z",
  visible:
    "M11,17C5.80945,17,3.66772,12.85,3.11339,11.575C2.9622,11.2,2.9622,10.8,3.11339,10.425C3.66772,9.15,5.80945,5,11,5C16.1654,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.1654,17,11,17ZM4.04567,10.8C3.99528,10.925,3.99528,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.48032,12.375,8.48032,11C8.48032,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z",
  invisible:
    "M5.80417,14.9887L4.62563,16.1673C4.43037,16.3625,4.43037,16.6791,4.62563,16.8744C4.82089,17.0696,5.13748,17.0696,5.33274,16.8744L6.62638,15.5807C7.75595,16.2901,9.19328,16.7929,11,16.7929C16.1654,16.7929,18.3323,12.64289,18.8866,11.36789C19.0378,10.99289,19.0378,10.59289,18.8866,10.21789C18.5549,9.45486,17.6456,7.66212,15.8617,6.34545L17.3536,4.853553C17.5488,4.658291,17.5488,4.341709,17.3536,4.146447C17.1583,3.9511845,16.8417,3.9511845,16.6464,4.146447L15.0014,5.7915C13.9314,5.1969,12.61166,4.792893,11,4.792893C5.80945,4.792893,3.66772,8.94289,3.11339,10.21789C2.9622,10.59289,2.9622,10.99289,3.11339,11.36789C3.42444,12.08333,4.2353,13.70399,5.80417,14.9887ZM7.36012,14.847C8.32327,15.4074,9.52286,15.7929,11,15.7929C15.5606,15.7929,17.4756,12.11789,17.9543,10.99289C18.0047,10.86789,18.0047,10.74289,17.9543,10.61789C17.659,9.90846,16.8171,8.23812,15.1447,7.06241L12.96929,9.23782C13.3134,9.66543,13.5197,10.20642,13.5197,10.79289C13.5197,12.16789,12.38583,13.29289,11,13.29289C10.41596,13.29289,9.87667,13.09308,9.44815,12.75896L7.36012,14.847ZM8.79461,11.99829L6.5201,14.2728C5.06905,13.12119,4.32057,11.62825,4.04567,10.96789C3.99528,10.84289,3.99528,10.71789,4.04567,10.59289C4.52441,9.46789,6.43937,5.79289,11,5.79289C12.28868,5.79289,13.3661,6.08632,14.2596,6.53329L12.19759,8.5953C11.84086,8.40257,11.43271,8.29289,11,8.29289C9.61417,8.29289,8.48032,9.41789,8.48032,10.79289C8.48032,11.22918,8.59447,11.64029,8.79461,11.99829ZM10.16528,12.04183C10.40487,12.20032,10.69207,12.29289,11,12.29289C11.8315,12.29289,12.51181,11.61789,12.51181,10.79289C12.51181,10.48318,12.41593,10.1946,12.25216,9.95494L10.16528,12.04183ZM11.43602,9.35687L9.55616,11.23674C9.512,11.09633,9.48819,10.94724,9.48819,10.79289C9.48819,9.96789,10.1685,9.29289,11,9.29289C11.15142,9.29289,11.29782,9.31528,11.43602,9.35687Z",
  remove:
    "M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z",
  lock: "M14.5 11V8.5C14.5 6.567 12.933 5 11 5C9.067 5 7.5 6.567 7.5 8.5V11H7C5.895 11 5 11.895 5 13V18C5 19.105 5.895 20 7 20H15C16.105 20 17 19.105 17 18V13C17 11.895 16.105 11 15 11H14.5ZM8.5 8.5C8.5 7.119 9.619 6 11 6C12.381 6 13.5 7.119 13.5 8.5V11H8.5V8.5ZM16 13V18C16 18.552 15.552 19 15 19H7C6.448 19 6 18.552 6 18V13C6 12.448 6.448 12 7 12H15C15.552 12 16 12.448 16 13Z",
  unlock:
    "M14.5 11H15C16.105 11 17 11.895 17 13V18C17 19.105 16.105 20 15 20H7C5.895 20 5 19.105 5 18V13C5 11.895 5.895 11 7 11H13.5V8.5C13.5 7.119 12.381 6 11 6C9.887 6 8.948 6.74 8.621 7.75L7.672 7.434C8.112 6.114 9.44 5 11 5C12.933 5 14.5 6.567 14.5 8.5V11ZM16 13C16 12.448 15.552 12 15 12H7C6.448 12 6 12.448 6 13V18C6 18.552 6.448 19 7 19H15C15.552 19 16 18.552 16 18V13Z",
};

// ============================================================================
// TOOL GROUPS
// ============================================================================

export const toolGroups: ToolGroup[] = [
  {
    id: "lines",
    label: "Lines",
    options: [
      {
        id: "horizontalStraightLine",
        label: "Horizontal Line",
        overlay: "horizontalStraightLine",
        icon: "horizontalStraightLine",
      },
      {
        id: "horizontalRayLine",
        label: "Horizontal Ray",
        overlay: "horizontalRayLine",
        icon: "horizontalRayLine",
      },
      {
        id: "horizontalSegment",
        label: "Horizontal Segment",
        overlay: "horizontalSegment",
        icon: "horizontalSegment",
      },
      {
        id: "verticalStraightLine",
        label: "Vertical Line",
        overlay: "verticalStraightLine",
        icon: "verticalStraightLine",
      },
      {
        id: "verticalRayLine",
        label: "Vertical Ray",
        overlay: "verticalRayLine",
        icon: "verticalRayLine",
      },
      {
        id: "verticalSegment",
        label: "Vertical Segment",
        overlay: "verticalSegment",
        icon: "verticalSegment",
      },
      {
        id: "straightLine",
        label: "Straight Line",
        overlay: "straightLine",
        icon: "straightLine",
      },
      {
        id: "rayLine",
        label: "Ray Line",
        overlay: "rayLine",
        icon: "rayLine",
      },
      {
        id: "segment",
        label: "Segment",
        overlay: "segment",
        icon: "segment",
      },
      {
        id: "priceLine",
        label: "Price Line",
        overlay: "priceLine",
        icon: "priceLine",
      },
      {
        id: "infoLine",
        label: "Info Line",
        overlay: "infoLine",
        icon: "infoLine",
      },
    ],
  },
  {
    id: "channels",
    label: "Channels",
    options: [
      {
        id: "priceChannelLine",
        label: "Price Channel",
        overlay: "priceChannelLine",
        icon: "priceChannelLine",
      },
      {
        id: "parallelStraightLine",
        label: "Parallel Channel",
        overlay: "parallelStraightLine",
        icon: "parallelStraightLine",
      },
    ],
  },
  {
    id: "shapes",
    label: "Shapes",
    options: [
      { id: "circle", label: "Circle", overlay: "circle", icon: "circle" },
      { id: "rect", label: "Rectangle", overlay: "rect", icon: "rect" },
    ],
  },
  {
    id: "fibonacci",
    label: "Fibonacci",
    options: [
      {
        id: "fibonacciLine",
        label: "Fib Retracement",
        overlay: "fibonacciLine",
        icon: "fibonacciLine",
      },
      {
        id: "fibonacciExtension",
        label: "Fib Extension",
        overlay: "fibonacciExtension",
        icon: "fibonacciExtension",
      },
    ],
  },
  {
    id: "waves",
    label: "Patterns",
    options: [
      {
        id: "xabcd",
        label: "XABCD Pattern",
        overlay: "xabcd",
        icon: "xabcd",
      },
      { id: "abcd", label: "ABCD Pattern", overlay: "abcd", icon: "abcd" },
    ],
  },
];

// ============================================================================
// HELPER FUNCTIONS
// ============================================================================

/**
 * Convert hex color to RGBA with specified opacity
 */
export function hexToRgba(hex: string, opacity: number): string {
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  return `rgba(${r}, ${g}, ${b}, ${opacity})`;
}

/**
 * Default tool selections for each group
 */
export const defaultSelectedToolByGroup: Record<string, string> = {
  lines: "horizontalStraightLine",
  channels: "priceChannelLine",
  shapes: "circle",
  fibonacci: "fibonacciLine",
  waves: "xabcd",
};
